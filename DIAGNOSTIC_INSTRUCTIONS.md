# üîç API & Database Diagnostic Instructions

## –ü—Ä–æ–±–ª–µ–º—ã –∫–æ—Ç–æ—Ä—ã–µ –º—ã –∏—Å–ø—Ä–∞–≤–ª—è–µ–º:

1. **Logout Error** - –æ—à–∏–±–∫–∞ 401 –ø—Ä–∏ logout (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ)
2. **–†–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –≤–∏–¥–Ω–∞** - –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ UI (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ)  
3. **API –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - —Ç–æ–∫–µ–Ω—ã –º–æ–≥—É—Ç –∏—Å—Ç–µ–∫–∞—Ç—å
4. **–ü—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ** - –Ω–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î
5. **Dev —ç–ª–µ–º–µ–Ω—Ç—ã** - —Å–∫—Ä—ã—Ç—ã –∑–∞ __DEV__ —Ñ–ª–∞–≥–æ–º

## –®–∞–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ Docker –∑–∞–ø—É—â–µ–Ω
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker ps

# –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–ø—É—Å—Ç–∏—Ç–µ
cd /Users/aniklidetz/Documents/MyPythonProject/MyHours/backend/myhours-backend
docker-compose up -d
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
```bash
# –í–æ–π–¥–∏—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Django
docker-compose exec web python debug_api.py

# –ò–ª–∏ –µ—Å–ª–∏ Docker –Ω–µ –∑–∞–ø—É—â–µ–Ω:
python debug_api.py
```

### 3. –ò—Å–ø—Ä–∞–≤—å—Ç–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
```bash
# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
docker-compose exec web python fix_auth_issues.py

# –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é 3 (Both) –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API endpoints –≤—Ä—É—á–Ω—É—é

#### –¢–µ—Å—Ç health check:
```bash
curl http://127.0.0.1:8000/api/health/
```

#### –¢–µ—Å—Ç login:
```bash
curl -X POST http://127.0.0.1:8000/api/v1/users/auth/enhanced-login/ \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@example.com",
    "password": "admin123",
    "device_id": "test_device_123",
    "device_info": {
      "platform": "test",
      "os_version": "1.0",
      "app_version": "1.0.0",
      "device_model": "Test Device",
      "device_id": "test_device_123"
    }
  }'
```

#### –¢–µ—Å—Ç —Å —Ç–æ–∫–µ–Ω–æ–º (–∑–∞–º–µ–Ω–∏—Ç–µ YOUR_TOKEN):
```bash
# Employees
curl -H "Authorization: DeviceToken YOUR_TOKEN" \
  http://127.0.0.1:8000/api/v1/users/employees/

# Work Time
curl -H "Authorization: DeviceToken YOUR_TOKEN" \
  http://127.0.0.1:8000/api/v1/worktime/worklogs/

# Payroll
curl -H "Authorization: DeviceToken YOUR_TOKEN" \
  http://127.0.0.1:8000/api/v1/payroll/salaries/
```

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ:

### ‚úÖ –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
1. **Logout error handling** - —Ç–µ–ø–µ—Ä—å –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç 401 –æ—à–∏–±–∫–∏ –ø—Ä–∏ logout
2. **Role display** - –¥–æ–±–∞–≤–ª–µ–Ω fallback –¥–ª—è undefined —Ä–æ–ª–∏  
3. **Cancel button navigation** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä—è–º—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é –≤–º–µ—Å—Ç–æ router.back()
4. **Dev elements** - —Å–∫—Ä—ã—Ç—ã –∑–∞ __DEV__ —Ñ–ª–∞–≥–æ–º
5. **Empty states** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è Work Time
6. **NaN calculations** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Payroll
7. **Date parsing** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ Work Time

### üîß –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

1. **–î–∞–Ω–Ω—ã–µ –≤ –ë–î**: –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∑–∞–ø–∏—Å–∏
2. **API –æ—Ç–≤–µ—Ç—ã**: –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 200 —Å –¥–∞–Ω–Ω—ã–º–∏
3. **–†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: –¥–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ Dashboard
4. **Logout**: –Ω–µ –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏

## –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

- **admin@example.com** / admin123 (Admin)
- **mikhail.plotnik@gmail.com** / admin123 (Accountant)  
- **employee1@example.com** / employee123 (Employee)

## –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞—é—Ç—Å—è:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Django: `docker-compose logs web`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB: `docker-compose logs mongodb`
3. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Expo
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ IP –∞–¥—Ä–µ—Å –≤ config.js –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

## –†–µ–∑—É–ª—å—Ç–∞—Ç:

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤:
- ‚úÖ Logout —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –†–æ–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ Dev —ç–ª–µ–º–µ–Ω—Ç—ã —Å–∫—Ä—ã—Ç—ã –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- ‚úÖ –ü—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è